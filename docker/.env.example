# =============================================================================
# YAWL v6.0.0-Beta Docker Environment Configuration
# =============================================================================
# Copy this file to .env and customize for your environment.
# All values shown are production-ready defaults.
#
# Usage:
#   cp docker/.env.example docker/.env
#   # Edit docker/.env with your settings
#   docker compose --env-file docker/.env up -d
# =============================================================================

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================
# Application name displayed in logs and monitoring
APP_NAME=YAWL

# Application version (leave empty to use build default)
APP_VERSION=

# Deployment environment: development, staging, production
APP_ENVIRONMENT=production

# Spring Boot active profiles (comma-separated)
# Options: production, staging, development, test
SPRING_PROFILES_ACTIVE=production

# Server timezone (IANA timezone identifier)
TZ=UTC

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# Database type: postgres, mysql, h2 (for development only)
DB_TYPE=postgres

# Database host (service name in Docker Compose, or external host)
DB_HOST=postgres

# Database port (default ports: PostgreSQL=5432, MySQL=3306, H2=9092)
DB_PORT=5432

# Database name
DB_NAME=yawl

# Database username (use secrets in production)
DB_USER=yawl

# Database password (REQUIRED - use strong password in production)
# WARNING: Change this default password before deployment!
DB_PASSWORD=yawl_secret_change_me

# JDBC URL override (optional - auto-generated from above if not set)
# DB_URL=jdbc:postgresql://postgres:5432/yawl

# =============================================================================
# DATABASE CONNECTION POOL (HikariCP)
# =============================================================================
# Maximum number of connections in the pool
# Increase for high-concurrency deployments
DB_POOL_MAX_SIZE=20

# Minimum number of idle connections
DB_POOL_MIN_IDLE=5

# Maximum time (ms) to wait for a connection from the pool
DB_POOL_CONNECTION_TIMEOUT=30000

# Maximum time (ms) a connection can sit idle in the pool
DB_POOL_IDLE_TIMEOUT=600000

# Maximum lifetime (ms) of a connection in the pool
DB_POOL_MAX_LIFETIME=1800000

# =============================================================================
# YAWL ENGINE SETTINGS
# =============================================================================
# Enable workflow persistence (recommended for production)
YAWL_PERSISTENCE_ENABLED=true

# Enable specification caching for improved performance
YAWL_SPEC_CACHE_ENABLED=true

# Maximum number of concurrent workflow cases
YAWL_MAX_CONCURRENT_CASES=1000

# Work item queue capacity before rejection
YAWL_WORKITEM_QUEUE_CAPACITY=500

# Enable automatic case cleanup for completed cases
YAWL_AUTO_CLEANUP_ENABLED=true

# Days to retain completed cases before cleanup
YAWL_CASE_RETENTION_DAYS=30

# Session timeout in minutes
YAWL_SESSION_TIMEOUT_MINUTES=60

# Maximum session cache size
YAWL_SESSION_CACHE_SIZE=1000

# =============================================================================
# JVM MEMORY SETTINGS
# =============================================================================
# Maximum heap memory (percentage of container memory)
# Example: 75.0 means 75% of container memory for heap
JVM_MAX_RAM_PERCENTAGE=75.0

# Initial heap memory (percentage of container memory)
JVM_INITIAL_RAM_PERCENTAGE=50.0

# Container memory limit (must match Docker/Kubernetes limits)
# Format: <number><unit> where unit = k, m, g
CONTAINER_MEMORY=2g

# Container CPU limit (number of cores)
CONTAINER_CPU=2.0

# =============================================================================
# VIRTUAL THREADS CONFIGURATION (Java 25)
# =============================================================================
# Virtual threads are enabled by default in Java 25
# Parallelism level for virtual thread scheduler
VIRTUAL_THREAD_PARALLELISM=200

# Maximum pool size for carrier threads
VIRTUAL_THREAD_MAX_POOL_SIZE=256

# Enable thread pinning diagnostics
VIRTUAL_THREAD_TRACE_PINNED=short

# =============================================================================
# GARBAGE COLLECTION (ZGC Generational)
# =============================================================================
# ZGC is optimized for low-latency, high-throughput workloads
# These settings are configured via JAVA_OPTS (see below)

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
# Root logging level: TRACE, DEBUG, INFO, WARN, ERROR, OFF
LOG_LEVEL_ROOT=INFO

# YAWL-specific logging level
LOG_LEVEL_YAWL=DEBUG

# Hibernate ORM logging level
LOG_LEVEL_HIBERNATE=WARN

# SQL query logging (set to DEBUG to see generated SQL)
LOG_LEVEL_HIBERNATE_SQL=OFF

# Spring Framework logging level
LOG_LEVEL_SPRING=WARN

# OpenTelemetry logging level
LOG_LEVEL_OTEL=INFO

# MCP integration logging level
LOG_LEVEL_MCP=INFO

# A2A integration logging level
LOG_LEVEL_A2A=INFO

# Log directory path (inside container)
LOG_DIR=/app/logs

# Enable JSON structured logging for log aggregation
LOG_JSON_ENABLED=false

# =============================================================================
# OPENTELEMETRY (OBSERVABILITY)
# =============================================================================
# Enable OpenTelemetry instrumentation
OTEL_ENABLED=false

# Service name for traces and metrics
OTEL_SERVICE_NAME=yawl-engine

# OTLP endpoint for traces (e.g., Jaeger, Tempo, SigNoz)
OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4317

# Trace exporter type: otlp, jaeger, zipkin, logging, none
OTEL_TRACES_EXPORTER=otlp

# Metrics exporter type: otlp, prometheus, logging, none
OTEL_METRICS_EXPORTER=prometheus

# Logs exporter type: otlp, logging, none
OTEL_LOGS_EXPORTER=otlp

# Sampling probability (1.0 = 100%, 0.1 = 10%)
OTEL_TRACES_SAMPLER_ARG=0.1

# Resource attributes (comma-separated key=value pairs)
OTEL_RESOURCE_ATTRIBUTES=deployment.environment=production

# =============================================================================
# PROMETHEUS METRICS
# =============================================================================
# Enable Prometheus metrics endpoint
PROMETHEUS_ENABLED=true

# Prometheus metrics endpoint path
PROMETHEUS_PATH=/actuator/prometheus

# Expose metrics on management port
MANAGEMENT_PORT=9090

# Health check details visibility: never, when-authorized, always
MANAGEMENT_HEALTH_SHOW_DETAILS=when-authorized

# Enable liveness and readiness probes
MANAGEMENT_HEALTH_PROBES_ENABLED=true

# =============================================================================
# SECURITY SETTINGS
# =============================================================================
# Enable HTTPS/TLS
SERVER_SSL_ENABLED=false

# Keystore path (inside container)
SERVER_SSL_KEYSTORE_PATH=/app/config/keystore.p12

# Keystore password (REQUIRED if SSL enabled)
SERVER_SSL_KEYSTORE_PASSWORD=

# Keystore type: PKCS12, JKS
SERVER_SSL_KEYSTORE_TYPE=PKCS12

# JWT secret for API authentication (REQUIRED for API access)
# WARNING: Generate a strong secret in production!
JWT_SECRET=change_this_to_a_secure_secret_min_256_bits

# JWT token expiration in seconds (default: 24 hours)
JWT_EXPIRATION=86400

# CORS allowed origins (comma-separated)
CORS_ALLOWED_ORIGINS=*

# Enable CSRF protection
CSRF_ENABLED=true

# Enable security headers (X-Content-Type-Options, X-Frame-Options, etc.)
SECURITY_HEADERS_ENABLED=true

# =============================================================================
# SPIFFE/SPIRE IDENTITY (OPTIONAL)
# =============================================================================
# Enable SPIFFE workload identity
SPIFFE_ENABLED=false

# SPIFFE socket path
SPIFFE_SOCKET=/run/spire/sockets/agent.sock

# Trust domain for SPIFFE IDs
SPIFFE_TRUST_DOMAIN=example.org

# =============================================================================
# MCP (MODEL CONTEXT PROTOCOL) INTEGRATION
# =============================================================================
# Enable MCP server
MCP_ENABLED=false

# MCP server port
MCP_PORT=8081

# MCP server hostname
MCP_HOSTNAME=0.0.0.0

# =============================================================================
# A2A (AGENT-TO-AGENT) INTEGRATION
# =============================================================================
# Enable A2A server
A2A_ENABLED=false

# A2A server port
A2A_PORT=8082

# A2A server hostname
A2A_HOSTNAME=0.0.0.0

# =============================================================================
# Z.AI INTEGRATION (OPTIONAL)
# =============================================================================
# Enable Z.AI integration for intelligent workflow routing
ZAI_ENABLED=false

# Z.AI API key (REQUIRED if ZAI_ENABLED=true)
ZAI_API_KEY=

# Z.AI API endpoint
ZAI_API_ENDPOINT=https://api.z.ai.anthropic.com

# Request timeout in milliseconds
ZAI_TIMEOUT_MS=10000

# Maximum retry attempts
ZAI_RETRY_MAX_ATTEMPTS=3

# =============================================================================
# FEATURE FLAGS
# =============================================================================
# Enable experimental Petri Net optimizations
FEATURE_PETRI_NET_OPTIMIZATIONS=false

# Enable multi-tenant mode
FEATURE_MULTI_TENANT=false

# Enable worklet dynamic adaptation
FEATURE_WORKLET_ADAPTATION=true

# Enable resource autoflow
FEATURE_RESOURCE_AUTOFLOW=true

# Enable case migration
FEATURE_CASE_MIGRATION=false

# Enable async event processing
FEATURE_ASYNC_EVENTS=true

# =============================================================================
# RESILIENCE SETTINGS (Resilience4j)
# =============================================================================
# Circuit breaker failure rate threshold (percentage)
RESILIENCE_CIRCUIT_BREAKER_FAILURE_THRESHOLD=50

# Circuit breaker wait duration in open state (seconds)
RESILIENCE_CIRCUIT_BREAKER_WAIT_DURATION=30

# Retry maximum attempts
RESILIENCE_RETRY_MAX_ATTEMPTS=3

# Rate limiter requests per period
RESILIENCE_RATE_LIMITER_LIMIT=100

# Rate limiter period (seconds)
RESILIENCE_RATE_LIMITER_PERIOD=1

# Bulkhead max concurrent calls
RESILIENCE_BULKHEAD_MAX_CONCURRENT=25

# =============================================================================
# HEALTH CHECK SETTINGS
# =============================================================================
# Health check interval (seconds)
HEALTH_CHECK_INTERVAL=30

# Health check timeout (seconds)
HEALTH_CHECK_TIMEOUT=10

# Health check start period (seconds) - time for app to start
HEALTH_CHECK_START_PERIOD=90

# Health check retries before marking unhealthy
HEALTH_CHECK_RETRIES=3

# =============================================================================
# RESOURCE SERVICE (OPTIONAL)
# =============================================================================
# Enable resource service
RESOURCE_SERVICE_ENABLED=true

# Resource service port
RESOURCE_SERVICE_PORT=8083

# =============================================================================
# WORKLET SERVICE (OPTIONAL)
# =============================================================================
# Enable worklet service
WORKLET_ENABLED=true

# Worklet exception handling: log, queue, reject
WORKLET_EXCEPTION_HANDLING=log

# =============================================================================
# SCHEDULING SERVICE (OPTIONAL)
# =============================================================================
# Enable scheduling service
SCHEDULING_ENABLED=true

# =============================================================================
# EXTERNAL SERVICE URLs (FOR DOCKER COMPOSE)
# =============================================================================
# PostgreSQL connection (if using external database)
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

# MySQL connection (alternative database)
MYSQL_HOST=mysql
MYSQL_PORT=3306

# Redis cache (optional, for distributed caching)
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_ENABLED=false

# RabbitMQ message broker (optional)
RABBITMQ_HOST=rabbitmq
RABBITMQ_PORT=5672
RABBITMQ_ENABLED=false

# =============================================================================
# ADMIN CREDENTIALS (FIRST RUN ONLY)
# =============================================================================
# Default admin username (created on first startup)
ADMIN_USERNAME=admin

# Default admin password (REQUIRED - change immediately after first login!)
# WARNING: This must be changed in production!
ADMIN_PASSWORD=admin

# Admin email for notifications
ADMIN_EMAIL=admin@example.org

# =============================================================================
# BACKUP SETTINGS
# =============================================================================
# Enable automatic backups
BACKUP_ENABLED=false

# Backup schedule (cron expression)
# Examples: "0 2 * * *" (daily at 2 AM), "0 3 * * 0" (weekly Sunday 3 AM)
BACKUP_SCHEDULE=0 2 * * *

# Backup retention days (backups older than this are deleted)
BACKUP_RETENTION_DAYS=7

# Backup storage path (local or mounted volume)
BACKUP_PATH=/app/backups

# Backup type: full, database, files
BACKUP_TYPE=full

# Enable backup compression (gzip)
BACKUP_COMPRESS=true

# Enable GPG encryption for backups
BACKUP_ENCRYPT=false

# GPG key ID for encryption (required if BACKUP_ENCRYPT=true)
BACKUP_GPG_KEY=

# Verify backup integrity after creation
BACKUP_VERIFY=true

# =============================================================================
# EXTERNAL BACKUP STORAGE (OPTIONAL)
# =============================================================================
# S3 bucket for backup uploads (requires AWS CLI)
# Format: bucket-name or bucket-name/path/prefix
BACKUP_S3_BUCKET=

# SFTP host for backup uploads
# Format: user@hostname or user@hostname:port
BACKUP_SFTP_HOST=

# External path for backup copies (NFS, mounted volume, etc.)
# Example: /mnt/backup-storage
BACKUP_EXTERNAL_PATH=

# =============================================================================
# RESTORE SETTINGS
# =============================================================================
# Verify backups before restore
RESTORE_VERIFY=true

# Create backup of current state before restore
RESTORE_BACKUP_CURRENT=true

# Skip confirmation prompts (use with caution)
RESTORE_FORCE=false

# GPG passphrase for encrypted backup restore
# WARNING: Set via RESTORE_GPG_PASSPHRASE_FILE for production
RESTORE_GPG_PASSPHRASE=

# Path to file containing GPG passphrase (more secure)
RESTORE_GPG_PASSPHRASE_FILE=

# =============================================================================
# DEVELOPMENT/DEBUG SETTINGS
# =============================================================================
# Enable remote debugging
DEBUG_ENABLED=false

# Remote debugging port
DEBUG_PORT=5005

# Enable JMX monitoring
JMX_ENABLED=false

# JMX port
JMX_PORT=9010

# =============================================================================
# ADVANCED JVM OPTIONS
# =============================================================================
# Additional JVM options (space-separated)
# These are appended to the default JAVA_OPTS in Dockerfile
JVM_EXTRA_OPTS=

# Full JAVA_OPTS override (uncomment to replace all defaults)
# JAVA_OPTS=-XX:+UseContainerSupport -XX:MaxRAMPercentage=75.0 -XX:+UseZGC

# Enable heap dump on OOM
JVM_HEAP_DUMP_ON_OOM=true

# Heap dump path
JVM_HEAP_DUMP_PATH=/app/logs/heap-dump.hprof

# Exit on out of memory error
JVM_EXIT_ON_OOM=true

# =============================================================================
# YAWL SPECIFICATION SETTINGS
# =============================================================================
# Specification storage path
SPEC_PATH=/app/specifications

# Enable specification hot reload
SPEC_HOT_RELOAD=false

# Specification validation strictness: strict, lenient, none
SPEC_VALIDATION=strict

# =============================================================================
# DATA DIRECTORY SETTINGS
# =============================================================================
# Data storage path (for file-based persistence)
DATA_PATH=/app/data

# Temporary files path
TEMP_PATH=/app/temp

# Configuration files path
CONFIG_PATH=/app/config
