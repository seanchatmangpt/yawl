PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX yawl: <http://www.yawlfoundation.org/yawlschema#>

# Validate task flow structure
# Detects orphaned tasks or unreachable elements

SELECT ?task ?issue
WHERE {
  ?task a yawl:Task ;
        yawl:id ?taskId .

  {
    # Task with no incoming flows
    FILTER NOT EXISTS {
      ?predecessor yawl:flowsTo ?task .
    }
    FILTER NOT EXISTS {
      ?spec yawl:rootNet ?net .
      ?net yawl:inputCondition ?task .
    }
    BIND("Task has no incoming flows and is not reachable from input condition" AS ?issue)
  } UNION {
    # Task with no outgoing flows
    FILTER NOT EXISTS {
      ?task yawl:flowsTo ?successor .
    }
    FILTER NOT EXISTS {
      ?spec yawl:rootNet ?net .
      ?net yawl:outputCondition ?task .
    }
    BIND("Task has no outgoing flows and does not reach output condition" AS ?issue)
  }
}
