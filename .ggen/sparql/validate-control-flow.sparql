PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX yawl: <http://www.yawlfoundation.org/yawlschema#>

# Validate control flow (join/split) semantics
# Ensures join and split types are compatible with connected flows

SELECT ?task ?taskId ?splitType ?joinType ?issue
WHERE {
  ?task a yawl:Task ;
        yawl:id ?taskId ;
        yawl:hasSplit ?splitElm ;
        yawl:hasJoin ?joinElm .

  ?splitElm yawl:code ?splitType .
  ?joinElm yawl:code ?joinType .

  {
    # Invalid split type
    FILTER (?splitType NOT IN ("and", "or", "xor"))
    BIND("Invalid split type" AS ?issue)
  } UNION {
    # Invalid join type
    FILTER (?joinType NOT IN ("and", "or", "xor"))
    BIND("Invalid join type" AS ?issue)
  }
}
