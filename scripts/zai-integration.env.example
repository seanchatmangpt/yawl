# Z.AI / ZHIPU API Integration Environment Configuration
#
# Source this file before running run-integration-tests.sh or start-mcp-server.sh:
#   source scripts/zai-integration.env.example
#
# For local development: copy to scripts/zai-integration.env and set real values.
# NEVER commit scripts/zai-integration.env to source control (it is in .gitignore).
#
# Z.AI (ZHIPU AI) powers the yawl_natural_language MCP tool:
#   - Translates natural language queries into YAWL engine API calls
#   - Uses GLM-4 with function calling for structured workflow operations
#   - API reference: https://open.bigmodel.cn/dev/api
#
# Kubernetes secret management:
#   - ZAI_API_KEY / ZHIPU_API_KEY are stored in the 'zai-secrets' Kubernetes Secret
#   - See k8s/zai-secrets.yaml for the Secret structure and ESO configuration
#   - CI/CD pipeline injects ZHIPU_API_KEY from GitHub Actions secrets

# ── Required: YAWL Engine Connection ─────────────────────────────────────────
export YAWL_ENGINE_URL="${YAWL_ENGINE_URL:-http://localhost:8080/yawl}"
export YAWL_USERNAME="${YAWL_USERNAME:-admin}"
export YAWL_PASSWORD="${YAWL_PASSWORD:-YAWL}"

# ── Service endpoints ─────────────────────────────────────────────────────────
export MCP_SERVER_URL="${MCP_SERVER_URL:-http://localhost:3000}"
export A2A_AGENT_URL="${A2A_AGENT_URL:-http://localhost:8081}"

# ── Z.AI / ZHIPU API Key (Required for yawl_natural_language MCP tool) ────────
# Primary variable name consumed by YAWL MCP Server and ZaiFunctionService:
# export ZAI_API_KEY="your-zhipu-api-key-here"
#
# ZHIPU platform alias (also accepted, mapped to ZAI_API_KEY at startup):
# export ZHIPU_API_KEY="your-zhipu-api-key-here"
#
# CI/CD: set ZHIPU_API_KEY in GitHub Actions repository secrets.
# The mcp-deploy.yml workflow maps it to ZAI_API_KEY in the K8s Secret.

# ── Z.AI Model Configuration (optional overrides) ─────────────────────────────
# Default model for function calling (GLM-4 family):
# export ZAI_MODEL="glm-4-0520"
#
# Override if API returns "Unknown Model" (newer model variants):
# export ZAI_MODEL="glm-4.6"
# export ZAI_MODEL="GLM-4.7-Flash"

# ── Agent Discovery Configuration ────────────────────────────────────────────
# YAWL A2A server for agent-to-agent communication:
export A2A_SERVER_HOST="${A2A_SERVER_HOST:-localhost}"
export A2A_SERVER_PORT="${A2A_SERVER_PORT:-8888}"

# Agent discovery interval (seconds):
export A2A_DISCOVERY_INTERVAL="${A2A_DISCOVERY_INTERVAL:-30}"
