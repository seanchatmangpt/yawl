<?xml version="1.0" encoding="UTF-8"?>
<specificationSet version="4.0" xmlns="http://www.yawlfoundation.org/yawlschema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.yawlfoundation.org/yawlschema http://www.yawlfoundation.org/yawlschema/YAWL_Schema4.0.xsd">
  <specification uri="multipleInstance">
    <metaData>
      <title>Multiple Instance Workflow</title>
      <creator>YAWL Z.ai Generator</creator>
      <description>Multiple instance task with dynamic creation</description>
      <version>1.0</version>
    </metaData>
    <decomposition id="miFlow" xsi:type="NetFactsType" isRootNet="true">
      <name>Multiple Instance Flow</name>
      <inputParam name="itemList">
        <type>xs:string</type>
      </inputParam>
      <localVariable name="processedItems">
        <type>xs:string</type>
        <initialValue>""</initialValue>
      </localVariable>
      <processControlElements>
        <inputCondition id="start">
          <name>Start</name>
          <flowsInto>
            <nextElementRef id="miTask"/>
          </flowsInto>
        </inputCondition>
        <task id="miTask" xsi:type="MultipleInstanceExternalTaskFactsType">
          <name>Process Multiple Items</name>
          <documentation>Processes each item from the input list</documentation>
          <flowsInto>
            <nextElementRef id="end"/>
          </flowsInto>
          <join code="xor"/>
          <split code="and"/>
          <minimum>3</minimum>
          <maximum>10</maximum>
          <threshold>5</threshold>
          <creationMode code="dynamic"/>
          <miDataInput>
            <expression query="/data/itemList"/>
            <splittingExpression query="for $item in /data/itemList/* return $item"/>
            <formalInputParam>item</formalInputParam>
          </miDataInput>
          <completedMappings>
            <mapping>
              <expression query="concat(/data/processedItems, $result, '; ')"/>
              <mapsTo>processedItems</mapsTo>
            </mapping>
          </completedMappings>
        </task>
        <outputCondition id="end">
          <name>End</name>
        </outputCondition>
      </processControlElements>
    </decomposition>
  </specification>
</specificationSet>