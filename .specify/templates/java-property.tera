/**
 * Generated by ggen from YAWL OWL 2 DL Ontology v6.0.0
 * Source: yawl-ontology.ttl
 * Generated: {{ generated.timestamp }}
 *
 * DO NOT EDIT - Changes will be overwritten on next generation
 */
package {{ java_package }}.properties;

import org.yawlfoundation.yawl.generated.annotation.Generated;
import javax.annotation.Nonnull;
import javax.annotation.Nullable;
import java.io.Serializable;
import java.util.Objects;

/**
 * {{ property.label | default(value=property.name) }} Property Accessor
 *
 * {% if property.comment -%}
 * <p>
 * {{ property.comment }}
 * </p>
 * {% endif -%}
 *
 * OWL Property: <code>{{ property.uri }}</code>
 *
 * <p>
 * <strong>Property Type:</strong> {{ property.property_type }}<br>
 * <strong>Domain:</strong> {{ property.domain }}<br>
 * <strong>Range:</strong> {{ property.range }}
 * </p>
 *
 * {% if property.min_cardinality %}
 * <p><strong>Minimum Cardinality:</strong> {{ property.min_cardinality }}</p>
 * {% endif -%}
 *
 * {% if property.max_cardinality %}
 * <p><strong>Maximum Cardinality:</strong> {{ property.max_cardinality }}</p>
 * {% endif -%}
 *
 * @author YAWL Foundation
 * @version {{ generated.version }}
 * @since 6.0.0
 */
@Generated(
    value = "org.yawlfoundation.ggen.CodeGenerator",
    date = "{{ generated.timestamp }}",
    comments = "Generated from ontology property: {{ property.uri }}"
)
public class {{ property.name | pascalcase }}Property implements Serializable {

    private static final long serialVersionUID = 1L;

    // Property metadata
    public static final String PROPERTY_URI = "{{ property.uri }}";
    public static final String PROPERTY_NAME = "{{ property.name }}";
    public static final String PROPERTY_TYPE = "{{ property.property_type }}";
    public static final String DOMAIN = "{{ property.domain }}";
    public static final String RANGE = "{{ property.range }}";
    public static final int MIN_CARDINALITY = {{ property.min_cardinality | default(value=0) }};
    public static final int MAX_CARDINALITY = {{ property.max_cardinality | default(value=-1) }}; // -1 = unbounded
    public static final boolean IS_FUNCTIONAL = {{ property.is_functional | default(value="false") }};

    private final {% if property.is_mandatory %}final{% else %}{% endif %} {{ property.java_type }} value;

    /**
     * Construct a property with a value
     *
     * @param value the property value
     * {% if property.is_mandatory -%}
     * @throws IllegalArgumentException if value is null
     * {% endif -%}
     */
    public {{ property.name | pascalcase }}Property(
        {% if property.is_mandatory %}@Nonnull{% else %}@Nullable{% endif %} {{ property.java_type }} value
    ) {
{% if property.is_mandatory -%}
        this.value = Objects.requireNonNull(value, "{{ property.name }} cannot be null");
{% else -%}
        this.value = value;
{% endif -%}
    }

    /**
     * Get the property value
     *
     * @return the property value{% if property.is_mandatory %} (never null){% endif %}
     */
    {% if property.is_mandatory %}@Nonnull{% else %}@Nullable{% endif %}
    public {{ property.java_type }} getValue() {
        return value;
    }

    /**
     * Check if this property has a value
     *
     * @return true if the value is not null
     */
    public boolean hasValue() {
        return value != null;
    }

    /**
     * Get the RDF representation of this property
     *
     * @return RDF triple predicate statement
     */
    @Nonnull
    public String toRdf() {
        if (value == null) {
            throw new IllegalStateException("Cannot serialize null property value");
        }
        return PROPERTY_URI + " " + toRdfValue(value) + " .";
    }

    /**
     * Convert value to RDF format
     *
     * @param value the value to convert
     * @return RDF literal or IRI representation
     */
    private static String toRdfValue(Object value) {
        if (value == null) {
            return "null";
        }
        if (value instanceof String) {
            return "\"" + escapeRdf((String) value) + "\"";
        } else if (value instanceof Boolean) {
            return "\"" + value + "\"^^<http://www.w3.org/2001/XMLSchema#boolean>";
        } else if (value instanceof Integer) {
            return "\"" + value + "\"^^<http://www.w3.org/2001/XMLSchema#integer>";
        } else if (value instanceof Long) {
            return "\"" + value + "\"^^<http://www.w3.org/2001/XMLSchema#long>";
        } else if (value instanceof Double) {
            return "\"" + value + "\"^^<http://www.w3.org/2001/XMLSchema#double>";
        }
        return "<" + value.toString() + ">";
    }

    /**
     * Escape special characters for RDF
     *
     * @param str the string to escape
     * @return escaped string safe for RDF literal
     */
    private static String escapeRdf(String str) {
        return str
            .replace("\\", "\\\\")
            .replace("\"", "\\\"")
            .replace("\n", "\\n")
            .replace("\r", "\\r");
    }

    /**
     * Validate the property value against constraints
     *
     * @return true if the value satisfies all constraints
     * @throws IllegalArgumentException if validation fails
     */
    public boolean validate() {
        // Cardinality checks
        if (MIN_CARDINALITY > 0 && value == null) {
            throw new IllegalArgumentException(
                PROPERTY_NAME + " is mandatory but value is null"
            );
        }

        // Type-specific validation
        if (value != null) {
            {% if property.property_type == "String" -%}
            if (value.isEmpty()) {
                throw new IllegalArgumentException(PROPERTY_NAME + " cannot be empty");
            }
            {% endif -%}

            {% if property.min_length -%}
            if (value.length() < {{ property.min_length }}) {
                throw new IllegalArgumentException(
                    PROPERTY_NAME + " must be at least {{ property.min_length }} characters"
                );
            }
            {% endif -%}

            {% if property.max_length -%}
            if (value.length() > {{ property.max_length }}) {
                throw new IllegalArgumentException(
                    PROPERTY_NAME + " must be at most {{ property.max_length }} characters"
                );
            }
            {% endif -%}

            {% if property.pattern -%}
            if (!value.matches("{{ property.pattern }}")) {
                throw new IllegalArgumentException(
                    PROPERTY_NAME + " does not match pattern: {{ property.pattern }}"
                );
            }
            {% endif -%}
        }

        return true;
    }

    @Override
    public boolean equals(Object obj) {
        if (!(obj instanceof {{ property.name | pascalcase }}Property)) {
            return false;
        }
        return Objects.equals(value, (({{ property.name | pascalcase }}Property) obj).value);
    }

    @Override
    public int hashCode() {
        return Objects.hashCode(value);
    }

    @Override
    public String toString() {
        return PROPERTY_NAME + "(" + value + ")";
    }

    /**
     * Create a builder for property construction
     *
     * @return a new builder
     */
    public static Builder builder() {
        return new Builder();
    }

    /**
     * Builder for {{ property.name | pascalcase }}Property
     */
    public static class Builder {
        private {{ property.java_type }} value;

        /**
         * Set the property value
         *
         * @param value the value
         * @return this builder
         */
        @Nonnull
        public Builder value({{ property.java_type }} value) {
            this.value = value;
            return this;
        }

        /**
         * Build the property
         *
         * @return a new {{ property.name | pascalcase }}Property instance
         */
        @Nonnull
        public {{ property.name | pascalcase }}Property build() {
            return new {{ property.name | pascalcase }}Property(value);
        }
    }
}
