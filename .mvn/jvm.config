# YAWL v6.0.0-GA - JVM Configuration
#
# Part 4 Optimization: Leyden AOT Cache + Virtual Thread Optimization
#
# Key features:
# - Project Leyden AOT cache for 60-70% JVM startup reduction
# - Virtual thread scheduler optimized for 16-core machines
# - ZGC with generational mode for low-pause GC
# - Compact object headers for memory efficiency
#
# Usage:
#   export YAWL_AOT_CACHE=~/.yawl/aot/test-cache.aot
#   mvn test
#
# Generate AOT cache:
#   bash scripts/aot/generate-aot.sh

# Memory configuration
-Xms4g -Xmx8g

# Garbage collection: ZGC with generational mode (Java 21+)
-XX:+UseZGC
-XX:+ZGenerational

# Memory efficiency (Java 25+)
-XX:+UseCompactObjectHeaders
-XX:+UseStringDeduplication

# Metaspace for large codebases
-XX:MetaspaceSize=256m
-XX:MaxMetaspaceSize=512m

# JIT compilation
-XX:+TieredCompilation
-XX:TieredStopAtLevel=4
-XX:CompileThreshold=10000

# Parallelism (Part 3 + Part 4)
-Djava.util.concurrent.ForkJoinPool.common.parallelism=15
-Djdk.virtualThreadScheduler.parallelism=16

# Virtual thread pinning detection (Part 4)
# Logs warnings when virtual threads are pinned to carrier threads
-Djdk.tracePinnedThreads=short

# Leyden AOT Cache (Part 4)
# Use environment variable for flexibility, fallback to default path
# Note: Comment out if AOT cache causes issues
-XX:AOTCache=${env.YAWL_AOT_CACHE:${user.home}/.yawl/aot/test-cache.aot}

# Encoding
-Dfile.encoding=UTF-8

# Java 25 preview features
--enable-preview

# Maven build cache
-Dmaven.build.cache.enabled=true
-Dmaven.artifact.threads=8
