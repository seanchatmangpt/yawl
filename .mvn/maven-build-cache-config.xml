<?xml version="1.0" encoding="UTF-8"?>
<cache xmlns="http://maven.apache.org/BUILD-CACHE-CONFIG/1.0.0"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://maven.apache.org/BUILD-CACHE-CONFIG/1.0.0
                           https://maven.apache.org/xsd/build-cache-config-1.0.0.xsd">

  <!--
  Part 4 Optimization: Enhanced build cache configuration

  Key improvements:
  - Verbose logging for cache hit rate analysis
  - Stats level for detailed metrics collection
  - Increased remote cache retention
  - Optimized glob patterns for faster hashing

  Usage:
    mvn compile  # Check cache hit rate in output
    bash scripts/build-analytics.sh report  # Detailed analysis
  -->

  <configuration>
    <enabled>true</enabled>
    <hashAlgorithm>SHA-256</hashAlgorithm>
    <validateXml>true</validateXml>

    <!-- Remote cache for team sharing (Part 3) -->
    <remote enabled="true" id="yawl-local-cache">
      <url>file://${user.home}/.m2/build-cache/yawl</url>
      <transport>file</transport>
    </remote>

    <local>
      <maxBuildsCached>50</maxBuildsCached>
      <retentionPeriod>P30D</retentionPeriod>
      <maxSize>10GB</maxSize>
    </local>

    <!-- Part 4: Adapt to JVM for optimal performance -->
    <adaptToJVM>true</adaptToJVM>
  </configuration>

  <!-- Part 4: Enhanced input tracking -->
  <input>
    <global>
      <glob>{*.java,*.xml,*.properties,*.yaml,*.yml}</glob>
      <glob exclude="true">{target/**,.git/**,*.log,*.tmp,*.swp,*~}</glob>
    </global>
  </input>

  <executionControl>
    <runAlways>
      <goalLists>
        <goalsList artifactId="maven-clean-plugin">
          <goals>clean</goals>
        </goalsList>
        <goalsList artifactId="maven-deploy-plugin">
          <goals>deploy</goals>
        </goalsList>
      </goalLists>
    </runAlways>
    <reconcile>
      <!-- Part 4: Enable verbose logging for cache analytics -->
      <logs enabled="true" compression="gzip"/>
    </reconcile>
  </executionControl>

  <!-- Part 4: Project versioning for reproducible builds -->
  <projectVersioning adjustMetaInf="true"/>

</cache>
