suite: YAWL Helm Chart Tests
templates:
  - configmap.yaml
  - secrets.yaml
  - services.yaml
  - deployments/*.yaml
tests:
  - it: should create configmap with correct data
    template: configmap.yaml
    asserts:
      - isKind:
          of: ConfigMap
      - hasDocuments:
          count: 2
      - containsDocument:
          kind: ConfigMap
          name: RELEASE-NAME-yawl-config

  - it: should create secrets
    template: secrets.yaml
    asserts:
      - isKind:
          of: Secret
      - hasDocuments:
          count: 2

  - it: should create engine deployment with correct replicas
    template: deployments/engine-deployment.yaml
    release:
      name: test
    asserts:
      - isKind:
          of: Deployment
      - equal:
          path: spec.replicas
          value: 2

  - it: should create services for all components
    template: services.yaml
    asserts:
      - isKind:
          of: Service
      - hasDocuments:
          count: 11

  - it: should set correct service ports
    template: services.yaml
    release:
      name: test
    asserts:
      - equal:
          path: spec.ports[0].port
          value: 8080
