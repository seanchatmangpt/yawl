# HikariCP Configuration for MySQL 8.0.36
# Production-ready connection pool settings for YAWL with MySQL

# =============================================================================
# MYSQL DATASOURCE CONFIGURATION
# =============================================================================

# JDBC URL with MySQL 8.0 parameters
jdbcUrl=jdbc:mysql://localhost:3306/yawl?\
  useSSL=false&\
  serverTimezone=UTC&\
  allowPublicKeyRetrieval=true&\
  useServerPrepStmts=true&\
  cachePrepStmts=true&\
  prepStmtCacheSize=250&\
  prepStmtCacheSqlLimit=2048&\
  cacheResultSetMetadata=true&\
  cacheServerConfiguration=true&\
  useLocalSessionState=true&\
  elideSetAutoCommits=true&\
  maintainTimeStats=false&\
  rewriteBatchedStatements=true

# Driver class (auto-detected by HikariCP)
driverClassName=com.mysql.cj.jdbc.Driver

# Credentials
username=yawl
password=changeme

# Pool name for identification
poolName=YAWL-MySQL-Pool

# =============================================================================
# POOL SIZE CONFIGURATION (optimized for virtual threads)
# =============================================================================

# Maximum pool size
maximumPoolSize=20

# Minimum idle connections
minimumIdle=5

# =============================================================================
# TIMEOUT CONFIGURATION
# =============================================================================

# Connection timeout - 30 seconds
connectionTimeout=30000

# Idle timeout - 10 minutes (MySQL default wait_timeout is 8 hours)
idleTimeout=600000

# Max lifetime - 30 minutes (less than MySQL's max_lifetime)
maxLifetime=1800000

# Validation timeout
validationTimeout=5000

# Leak detection threshold - 60 seconds
leakDetectionThreshold=60000

# =============================================================================
# CONNECTION TESTING
# =============================================================================

# Connection test query (lightweight for MySQL)
connectionTestQuery=SELECT 1

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================

# Keepalive time - 2 minutes
keepaliveTime=120000

# =============================================================================
# MONITORING
# =============================================================================

# Enable JMX for pool monitoring
registerMbeans=true

# Allow pool suspension
allowPoolSuspension=true

# =============================================================================
# MYSQL-SPECIFIC DATA SOURCE PROPERTIES
# =============================================================================

# These are passed to the MySQL DataSource
dataSource.cachePrepStmts=true
dataSource.prepStmtCacheSize=250
dataSource.prepStmtCacheSqlLimit=2048
dataSource.useServerPrepStmts=true
dataSource.useLocalSessionState=true
dataSource.rewriteBatchedStatements=true
dataSource.cacheResultSetMetadata=true
dataSource.cacheServerConfiguration=true
dataSource.elideSetAutoCommits=true
dataSource.maintainTimeStats=false

# =============================================================================
# SSL CONFIGURATION (for production)
# =============================================================================

# Uncomment for SSL connections
#jdbcUrl=jdbc:mysql://localhost:3306/yawl?\
#  useSSL=true&\
#  requireSSL=true&\
#  verifyServerCertificate=true&\
#  trustCertificateKeyStoreUrl=file:/path/to/truststore.jks&\
#  trustCertificateKeyStorePassword=changeme&\
#  clientCertificateKeyStoreUrl=file:/path/to/keystore.jks&\
#  clientCertificateKeyStorePassword=changeme&\
#  serverTimezone=UTC
