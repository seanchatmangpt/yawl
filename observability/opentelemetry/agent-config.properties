# OpenTelemetry Java Agent Configuration for YAWL
# This file configures the zero-code instrumentation via the Java agent
# Usage: java -javaagent:path/to/opentelemetry-javaagent.jar -Dotel.javaagent.configuration-file=agent-config.properties -jar yawl.war

# Service identification
otel.service.name=yawl-engine
otel.service.version=5.2
otel.service.namespace=yawl-workflows
otel.resource.attributes=deployment.environment=production,service.instance.id=${HOSTNAME}

# Exporter configuration (OTLP by default)
otel.traces.exporter=otlp
otel.metrics.exporter=otlp,prometheus
otel.logs.exporter=otlp

# OTLP endpoint configuration
otel.exporter.otlp.endpoint=http://otel-collector:4318
otel.exporter.otlp.protocol=http/protobuf
otel.exporter.otlp.timeout=30s
otel.exporter.otlp.compression=gzip

# OTLP Headers (for authentication if needed)
#otel.exporter.otlp.headers=Authorization=Bearer ${OTEL_AUTH_TOKEN}

# Traces configuration
otel.exporter.otlp.traces.endpoint=http://otel-collector:4318/v1/traces
otel.traces.sampler=parentbased_traceidratio
otel.traces.sampler.arg=0.1

# Metrics configuration
otel.exporter.otlp.metrics.endpoint=http://otel-collector:4318/v1/metrics
otel.metrics.exporter.interval=60000
otel.exporter.prometheus.host=0.0.0.0
otel.exporter.prometheus.port=9464

# Logs configuration
otel.exporter.otlp.logs.endpoint=http://otel-collector:4318/v1/logs
otel.logs.exporter=otlp

# Instrumentation configuration
# Enable all instrumentations by default, disable specific ones if needed
otel.instrumentation.common.default-enabled=true

# JDBC instrumentation (critical for YAWL)
otel.instrumentation.jdbc.enabled=true
otel.instrumentation.jdbc-datasource.enabled=true
otel.instrumentation.hibernate.enabled=true

# HTTP instrumentation
otel.instrumentation.servlet.enabled=true
otel.instrumentation.http.enabled=true
otel.instrumentation.tomcat.enabled=true

# Async instrumentation
otel.instrumentation.executors.enabled=true
otel.instrumentation.java-concurrent.enabled=true

# Additional instrumentations
otel.instrumentation.jaxrs.enabled=true
otel.instrumentation.jaxrs-client.enabled=true
otel.instrumentation.apache-httpclient.enabled=true
otel.instrumentation.log4j.enabled=true

# Batch span processor configuration
otel.bsp.schedule.delay=5000
otel.bsp.max.queue.size=8192
otel.bsp.max.export.batch.size=512
otel.bsp.export.timeout=30000

# Resource detection
otel.resource.providers.aws.enabled=true
otel.resource.providers.gcp.enabled=true
otel.resource.providers.azure.enabled=true

# Propagators (for distributed tracing)
otel.propagators=tracecontext,baggage,b3,b3multi,jaeger,ottrace,xray

# Span attributes configuration
otel.span.attribute.count.limit=128
otel.span.event.count.limit=128
otel.span.link.count.limit=128

# YAWL-specific instrumentation extensions
# These can be used with custom instrumentation
otel.instrumentation.yawl.enabled=true
otel.instrumentation.yawl.capture-case-data=true
otel.instrumentation.yawl.capture-workitem-data=true
otel.instrumentation.yawl.capture-specification-data=true

# Performance tuning
otel.javaagent.extensions.classes.enabled=true
otel.javaagent.debug=false
otel.javaagent.experimental.initializer.jar=false

# Logging
otel.javaagent.logging=application
io.opentelemetry.level=INFO

# Cloud-specific exporters (commented out, enable as needed)
# Google Cloud Trace
#otel.traces.exporter=google_cloud_trace
#otel.exporter.google.cloud.trace.project-id=${GCP_PROJECT_ID}

# AWS X-Ray
#otel.traces.exporter=xray
#otel.exporter.xray.region=us-east-1

# Azure Monitor
#otel.traces.exporter=azuremonitor
#otel.exporter.azuremonitor.connection.string=${AZURE_CONNECTION_STRING}

# Development mode overrides
# otel.traces.exporter=logging
# otel.metrics.exporter=logging
# otel.logs.exporter=logging
# otel.javaagent.debug=true
