# Trivy Secret Scan Allow-list for YAWL v6.0.0
# ==============================================
# Secrets that appear in source but are documented test fixtures only.
# Production secrets must NEVER be added here - use a secrets manager.

rules:
  # Allow YAWL's built-in test session token used only in unit tests
  - id: yawl-test-session-token
    category: generic
    title: "YAWL Test Session Token (allowed in test resources)"
    severity: LOW
    regex: "test-session-[a-z0-9]+-token"
    allowlist:
      paths:
        - "test/.*"
        - "src/org/yawlfoundation/yawl/integration/test/.*"

  # Allow the H2 in-memory database URL patterns (no real credentials)
  - id: h2-memory-url
    category: database
    title: "H2 In-Memory Database URL (no credentials)"
    severity: LOW
    regex: "jdbc:h2:mem:[a-z_]+"
    allowlist:
      paths:
        - ".*"
