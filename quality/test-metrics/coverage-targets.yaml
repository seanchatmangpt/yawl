# YAWL v6.0.0 Test Coverage Improvement Targets
# ==============================================
# These targets are enforced by the JaCoCo 'check' goal in the 'analysis' Maven profile.
# Each target has a current baseline (as of 2026-02-17) and a 2026-Q4 target.
#
# Enforcement command:
#   mvn clean verify -P analysis
#
# Current baseline measured from: BASELINE_TEST_STATUS_2026-02-16.txt

modules:
  yawl-engine:
    description: "Stateful workflow engine - YEngine, YNetRunner, persistence"
    coverage:
      current:
        line: 0.62
        branch: 0.52
        method: 0.65
      target_2026_q2:
        line: 0.70
        branch: 0.60
        method: 0.72
      target_2026_q4:
        line: 0.80
        branch: 0.70
        method: 0.82
    priority_classes:
      - "YEngine"         # Core engine - highest business value
      - "YNetRunner"      # Petri net execution - complex branching
      - "YWorkItem"       # Work item lifecycle state machine
      - "YPersistenceManager"  # Persistence layer - error handling paths
    focus_areas:
      - "OR-join cycle detection (currently 0 test coverage)"
      - "Case cancellation propagation"
      - "Concurrent workitem execution"
      - "YNetRunner.continueIfPossible() edge cases"

  yawl-elements:
    description: "Petri net element model - tasks, conditions, nets, flows"
    coverage:
      current:
        line: 0.71
        branch: 0.63
        method: 0.74
      target_2026_q2:
        line: 0.78
        branch: 0.70
        method: 0.80
      target_2026_q4:
        line: 0.85
        branch: 0.78
        method: 0.88
    priority_classes:
      - "YNet"            # Net verification logic
      - "YAtomicTask"     # Task firing rules
      - "YFlow"           # Flow predicate evaluation
      - "YMultiInstanceAttributes"  # MI task validation

  yawl-stateless:
    description: "Stateless in-memory workflow execution"
    coverage:
      current:
        line: 0.68
        branch: 0.58
        method: 0.71
      target_2026_q2:
        line: 0.75
        branch: 0.65
        method: 0.78
      target_2026_q4:
        line: 0.82
        branch: 0.72
        method: 0.85
    priority_classes:
      - "YStatelessEngine"   # Public API surface
      - "YCaseMonitor"       # Idle case detection
      - "YCaseImporter"      # State import/export
      - "YCaseExporter"      # State serialization

  yawl-authentication:
    description: "Session management, JWT, CSRF protection"
    coverage:
      current:
        line: 0.73
        branch: 0.64
        method: 0.76
      target_2026_q2:
        line: 0.80
        branch: 0.72
        method: 0.83
      target_2026_q4:
        line: 0.88
        branch: 0.80
        method: 0.90
    priority_classes:
      - "JwtManager"          # JWT generation/validation - security critical
      - "CsrfTokenManager"    # CSRF protection
      - "YSessionCache"       # Session lifecycle

  yawl-integration:
    description: "MCP, A2A, autonomous agent integration"
    coverage:
      current:
        line: 0.55
        branch: 0.44
        method: 0.58
      target_2026_q2:
        line: 0.65
        branch: 0.55
        method: 0.68
      target_2026_q4:
        line: 0.75
        branch: 0.65
        method: 0.78
    priority_classes:
      - "YawlMcpServer"       # MCP tool dispatch
      - "YawlA2AServer"       # A2A task handling
      - "YawlEngineAdapter"   # Engine integration bridge

  yawl-security:
    description: "SPIFFE workload identity, TLS, mutual authentication"
    coverage:
      current:
        line: 0.60
        branch: 0.50
        method: 0.63
      target_2026_q2:
        line: 0.70
        branch: 0.62
        method: 0.73
      target_2026_q4:
        line: 0.80
        branch: 0.72
        method: 0.83

# Improvement Strategy
# ====================
# Phase 1 (Q1 2026): Focus on engine and elements - highest business risk
# Phase 2 (Q2 2026): Stateless and authentication - correctness guarantees
# Phase 3 (Q3 2026): Integration and security - external interface coverage
# Phase 4 (Q4 2026): Achieve all Q4 targets before v6.1.0 release

jacoco_check_configuration:
  # Enforce these in the 'analysis' Maven profile.
  # Thresholds are conservative to avoid build failures during ramp-up.
  # Increase by 5% each quarter until Q4 targets are reached.
  current_enforcement:
    line_ratio: 0.65
    branch_ratio: 0.55
  next_quarter_enforcement:
    line_ratio: 0.70
    branch_ratio: 0.60
  halt_on_failure: false  # Report but don't block until Q3 2026
