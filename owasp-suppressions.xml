<?xml version="1.0" encoding="UTF-8"?>
<!--
  OWASP Dependency Check Suppressions - YAWL v6.0.0

  This file contains suppression rules for known false positives, accepted
  risks, and transitive dependencies in YAWL's Maven dependency tree.

  CRITICAL REQUIREMENTS:
  =====================
  1. QUARTERLY REVIEW: Review all suppressions every 3 months (Feb/May/Aug/Nov)
  2. JUSTIFICATION: Every suppression MUST have a detailed notes element
  3. EXPIRATION: Use 'until' attribute for time-bound suppressions
  4. NO BLANKET SUPPRESSION: Never suppress entire dependency families
  5. ESCALATE RISK: Document why risk is acceptable (e.g., test-only, optional)

  SUPPRESSION TYPES:
  ==================
  - False Positives: CVEs incorrectly flagged (dependency not vulnerable)
  - Accepted Risk: Known issues acceptable due to deployment/usage context
  - Transitive: Required by upstream dependency, upgrade path documented
  - Planned Upgrade: Known issue with scheduled fix in next release

  AUTOMATION:
  ===========
  - GitHub Actions workflow: .github/workflows/cve-scanning.yml
  - Runs daily at 02:00 UTC, on every commit to main/release branches
  - Fails build on HIGH/CRITICAL (CVSS >= 7.0)
  - Reports generated to: target/dependency-check/dependency-check-report.*

  POLICY:
  =======
  CVSS < 4.0 (LOW)      : Document and monitor
  CVSS 4.0-6.9 (MEDIUM) : Track for next release, add to quarterly review
  CVSS >= 7.0 (HIGH+)   : MUST REMEDIATE (fail CI/CD build)

  REFERENCE:
  ==========
  CVSS Scoring: https://nvd.nist.gov/vuln/detail/
  Dependency-Check: https://jeremylong.github.io/DependencyCheck/
  Maven Central: https://mvnrepository.com/

  Last Updated: 2026-02-20
-->
<suppressions xmlns="https://jeremylong.github.io/DependencyCheck/dependency-suppression.1.3.xsd">

    <!-- ================================================================== -->
    <!-- SECTION 1: FALSE POSITIVES                                        -->
    <!-- ================================================================== -->
    <!-- CVEs incorrectly flagged for our actual dependencies              -->
    <!-- These require verification that YAWL's usage is not vulnerable     -->
    <!-- ================================================================== -->

    <!-- Twitter4j - Optional Service, Not Core -->
    <!-- Risk Assessment: Twitter service is opt-in; YAWL functions without it -->
    <suppress>
        <notes>
            COMPONENT: Twitter4j (optional twitterService)
            STATUS: False Positive - CVEs relate to OAuth flow, not used by YAWL
            IMPACT: twitterService is optional and not required for core YAWL
            MITIGATION: Users should disable twitterService in configuration if not needed
            TRACKING: Upgrade to latest Twitter4j when available (currently EOL status)
            REVIEWED: 2026-02-20
        </notes>
        <packageUrl regex="true">^pkg:maven/org\.twitter4j/twitter4j\-core@.*$</packageUrl>
        <cpe>cpe:/a:twitter4j:twitter4j</cpe>
    </suppress>

    <!-- JUNG - Graph Visualization Library -->
    <!-- Risk Assessment: Only used for visualization, not user-facing data processing -->
    <suppress>
        <notes>
            COMPONENT: JUNG (Java Universal Network/Graph Framework)
            USAGE: Graph visualization in Proclet Service (UI only)
            SEVERITY: Typically UI/rendering issues, not core logic
            CONTEXT: Not exposed to external network input or untrusted data
            REMEDIATION: Monitor for updates; upgrade when available
            REVIEWED: 2026-02-20
        </notes>
        <packageUrl regex="true">^pkg:maven/net\.sf\.jung/jung.*@.*$</packageUrl>
    </suppress>


    <!-- ================================================================== -->
    <!-- SECTION 2: ACCEPTED RISKS                                         -->
    <!-- ================================================================== -->
    <!-- Known issues acceptable due to deployment context or usage        -->
    <!-- Includes time-limited suppressions for planned upgrades            -->
    <!-- ================================================================== -->

    <!-- H2 Database - Test/Development Only -->
    <!-- Risk Assessment: Never in production; PostgreSQL/MySQL used instead -->
    <suppress until="2026-12-31">
        <notes>
            COMPONENT: H2 Database Engine (test/development only)
            DEPLOYMENT: PRODUCTION uses PostgreSQL 42.7.7 or MySQL 9.4.0
            SCOPE: Test fixtures and CI/CD only (never in production)
            CVSS THRESHOLD: Accepting CVE &lt; 7.0 (low severity)
            UPGRADE PATH: H2 2.4.240 installed; will upgrade after Hibernate 6 stabilizes
            DEADLINE: 2026-12-31 - Complete migration then review
            REVIEWED: 2026-02-20
        </notes>
        <packageUrl regex="true">^pkg:maven/com\.h2database/h2@.*$</packageUrl>
        <cvssBelow>7.0</cvssBelow>
    </suppress>


    <!-- ================================================================== -->
    <!-- SECTION 3: TRANSITIVE DEPENDENCIES                                -->
    <!-- ================================================================== -->
    <!-- Dependencies pulled in by upstream libraries                      -->
    <!-- Documented with upgrade strategy and timeline                      -->
    <!-- ================================================================== -->

    <!-- ANTLR 2.7.7 - Required by Hibernate -->
    <!-- Risk Assessment: Legacy version required by current Hibernate; planned upgrade -->
    <suppress until="2026-06-30">
        <notes>
            COMPONENT: ANTLR 2.7.7 (parser generator)
            REASON: Transitive dependency of Hibernate 6.6.42.Final
            IMPACT: Required for JPA query compilation at runtime
            STATUS: EOL library (2012) - new Hibernate versions use ANTLR 4.x
            UPGRADE PLAN: Complete migration to Hibernate 7.0 by 2026-06-30
            TRACKING: https://github.com/hibernate/hibernate-orm/issues (reference)
            RISK LEVEL: Low-Medium (parsing only, not network-exposed)
            REVIEWED: 2026-02-20
        </notes>
        <packageUrl regex="true">^pkg:maven/antlr/antlr@2\.7\.7$</packageUrl>
        <cvssBelow>7.0</cvssBelow>
    </suppress>


    <!-- ================================================================== -->
    <!-- SECTION 4: PLANNED UPGRADES / KNOWN ISSUES                        -->
    <!-- ================================================================== -->
    <!-- CVEs with documented remediation and scheduled fix date            -->
    <!-- ================================================================== -->

    <!-- JSF/Jakarta Faces - Legacy Resource Service UI -->
    <!-- Risk Assessment: Deprecated UI framework; modern frontend planned -->
    <suppress until="2026-12-31">
        <notes>
            COMPONENT: Jakarta Faces (JSF) 4.1.2
            USAGE: Legacy Resource Service web UI (admin-only access)
            CONTEXT: Internal admin tool, typically behind VPN/firewall
            MITIGATION: Resource Service should be deployed behind network firewall
            UPGRADE PLAN: Migrate to React/Vue modern frontend by 2026-12-31
            DEPLOYMENT: Temporary suppression - expires when frontend migrated
            CVSS THRESHOLD: Accepting CVE &lt; 8.0 during transition period
            REVIEWED: 2026-02-20
        </notes>
        <packageUrl regex="true">^pkg:maven/.*jsf.*@.*$</packageUrl>
        <cvssBelow>8.0</cvssBelow>
    </suppress>

    <suppress until="2026-12-31">
        <notes>
            COMPONENT: Jakarta Faces Implementation (Glassfish Faces)
            USAGE: Same as above - legacy Resource Service UI
            STATUS: Same migration plan as JSF API
            REVIEWED: 2026-02-20
        </notes>
        <packageUrl regex="true">^pkg:maven/org\.glassfish/jakarta\.faces@.*$</packageUrl>
        <cvssBelow>8.0</cvssBelow>
    </suppress>


    <!-- ================================================================== -->
    <!-- SECTION 5: TEMPLATE FOR NEW SUPPRESSIONS                          -->
    <!-- ================================================================== -->
    <!-- Copy this template when adding new suppressions:                  -->
    <!-- ================================================================== -->

    <!--
    <suppress until="YYYY-MM-DD">
        <notes>
            COMPONENT: [Library name and version]
            REASON: [False positive / Accepted risk / Transitive / Planned upgrade]
            CONTEXT: [How/where this is used]
            RISK LEVEL: [Low/Medium/High + CVSS score if known]
            MITIGATION: [Any deployment or usage controls]
            UPGRADE PATH: [When/how this will be fixed]
            REVIEWED: YYYY-MM-DD
            OWNER: [GitHub username or team]
        </notes>
        <packageUrl regex="true">^pkg:maven/[groupId]/[artifactId]@.*$</packageUrl>
        <cvssBelow>7.0</cvssBelow>
    </suppress>
    -->


    <!-- ================================================================== -->
    <!-- QUARTERLY REVIEW CHECKLIST                                        -->
    <!-- ================================================================== -->
    <!-- Run this before each release (Q1/Q2/Q3/Q4):                       -->
    <!-- ================================================================== -->
    <!--
    CHECKLIST:
    [ ] Run: mvn -P security-audit dependency-check:check
    [ ] Review CVE database updates (NVD)
    [ ] Check expiration dates (until="YYYY-MM-DD")
    [ ] Verify transitive dependency status (any upgrades available?)
    [ ] Test production deployments (PostgreSQL, MySQL drivers)
    [ ] Update notes with latest reviewed date
    [ ] Remove expired suppressions (until date passed)
    [ ] Check GitHub issues for dependency updates
    [ ] Update CHANGELOG.md with security notes
    [ ] Commit changes with message: "chore: quarterly CVE suppression review (QXNN)"
    -->

</suppressions>
